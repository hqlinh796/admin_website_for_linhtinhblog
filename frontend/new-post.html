<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Admin</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css"
        integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">
    <link rel="stylesheet" href="index.css">
    <script src="https://kit.fontawesome.com/51d5218d26.js" crossorigin="anonymous"></script>
    <script src="https://cdn.tiny.cloud/1/hrzsxlxliacgdlj9c44dvc0edehdq8eoi0if6e143emfrc6m/tinymce/5/tinymce.min.js"
        referrerpolicy="origin"></script>

</head>

<body>
    <div class="wrapper">
        <!-- ---------- HEADER --------------- -->
        <nav class="navbar navbar-expand-lg navbar-light justify-content-between">
            <button class="navbar-toggler" data-target="#my-nav" data-toggle="collapse" aria-controls="my-nav"
                aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div id="my-nav" class="collapse navbar-collapse left-navbar pl-3">
                <ul class="navbar-nav">
                    <liv class="nav-item">
                        <a href="#" class="nav-link">
                            <i class="fas fa-bars"></i>
                        </a>
                    </liv>
                    <li class="nav-item active">
                        <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link disabled" href="#" tabindex="-1" aria-disabled="true">Contact</a>
                    </li>
                </ul>
                <form method="get" action="#" class="form-inline mr-auto">
                    <div class="input-group input-group-sm">
                        <input class="form-control rounded-0 border-0 bg-light" type="text" placeholder="">
                        <div class="input-group-append">
                            <button class="btn rounded-0 btn-light" type="button">
                                <i class="fas fa-search"></i>
                            </button>
                        </div>
                    </div>
                </form>
            </div>
            <div class="collapse navbar-collapse right-navbar pr-3">
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item active dropdown">
                        <a class="nav-link dropdown-toggle" href="#" data-toggle="dropdown">
                            <i class="far fa-comments"></i> <span class="sr-only"></span>
                        </a>
                        <div class="dropdown-menu dropdown-menu-right">
                            <div class="dropdown-item">Item</div>
                        </div>
                    </li>
                    <li class="nav-item mx-1">
                        <a class="nav-link disabled" href="#" tabindex="-1" aria-disabled="true">
                            <i class="far fa-bell"></i>
                        </a>

                    </li>

                    <li class="account nav-item account d-flex align-items-center">
                        <img alt="avatar" class="rounded-circle" style="height: 20px;"
                            src="https://i.pinimg.com/originals/c3/45/05/c34505eb63edc65300a690f1ad903799.jpg">
                        <a href="#" data-toggle="dropdown" class="dropdown-toggle text-decoration-none">
                        </a>
                        <div class="dropdown-menu dropdown-menu-right">
                            <div class="dropdown-item">
                                <a href="#" class="text-decoration-none"> My account</a>
                            </div>
                            <div class="dropdown-item">
                                <a href="#" class="text-decoration-none">
                                    Sign out
                                </a>
                            </div>
                        </div>
                    </li>
                </ul>
            </div>
        </nav>
        <!-- --------------- LEFT BAR ----------------- -->
        <section class="leftbar-wrapper bg-dark h-100 text-light px-2">
            <div class="leftbar">
                <div class="logo mb-5">
                    <img class="rounded-circle" style="height: 30px;" alt="logo"
                        src="https://upload.wikimedia.org/wikipedia/commons/a/ab/Android_O_Preview_Logo.png">
                    <h5 class="ml-2 mb-0">Admin template</h5>
                </div>
                <div class="leftbar-menu text-light">

                    <ul class="leftbar-content fc-1 list-unstyled">
                        <li class="leftbar-item">
                            <a href="#menu-1" class="leftbar-link collapse-toggle" data-toggle="collapse">
                                <div>
                                    <i class="fas fa-home mr-2 fc-1"></i>
                                    <span class="leftbar-item-title">
                                        Dashboard
                                    </span>
                                </div>
                                <div>
                                    <i class="fas fa-chevron-left"></i>
                                </div>
                            </a>
                            <ul id="menu-1" class="collapse list-unstyled">
                                <li class="leftbar-sub-item">
                                    <a href="#">
                                        <i class="far fa-circle mr-2"></i>
                                        Item 1
                                    </a>
                                </li>
                                <li class="leftbar-sub-item">
                                    <a href="#">
                                        <i class="far fa-circle mr-2"></i>
                                        Item 1
                                    </a>
                                </li>
                                <li class="leftbar-sub-item">
                                    <a href="#">
                                        <i class="far fa-circle mr-2"></i>
                                        Item 1
                                    </a>
                                </li>
                            </ul>
                        </li>
                        <li class="leftbar-item">
                            <a href="" class="leftbar-link">
                                <div>
                                    <i class="fas fa-tools mr-2"></i>
                                    <span class="leftbar-item-title">
                                        Tool 1
                                    </span>
                                </div>
                            </a>
                        </li>
                        <li class="leftbar-item active">
                            <a href="#menu-2" class="leftbar-link collapse-toggle" data-toggle="collapse">
                                <div>
                                    <i class="fas fa-pen-square mr-2"></i>
                                    <span class="leftbar-item-title">
                                        Post
                                    </span>
                                </div>
                                <div>
                                    <i class="fas fa-chevron-left"></i>
                                </div>
                            </a>

                            <ul id="menu-2" class="collapse list-unstyled">
                                <li class="leftbar-sub-item">
                                    <a href="new-post.html">
                                        <i class="far fa-circle mr-2"></i>
                                        New post
                                    </a>
                                </li>
                                <li class="leftbar-sub-item">
                                    <a href="manage-post.html">
                                        <i class="far fa-circle mr-2"></i>
                                        Manage post
                                    </a>
                                </li>
                            </ul>
                        </li>
                        <li class="leftbar-item">
                            <a href="#" class="leftbar-link">
                                <div>
                                    <i class="fas fa-tools mr-2"></i>
                                    <span class="leftbar-item-title">
                                        Tool 3
                                    </span>
                                </div>
                            </a>
                        </li>
                    </ul>

                </div>
        </section>
        
        <footer>
            Footer
        </footer>

    </div>


    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
        integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>

    <script>
        tinymce.init({
            selector: '#f-content',
            plugins: 'image code a11ychecker advcode casechange formatpainter linkchecker autolink lists checklist media mediaembed pageembed permanentpen powerpaste table advtable tinycomments tinymcespellchecker',
            toolbar: 'undo redo | link image | code a11ycheck addcomment showcomments casechange checklist code formatpainter pageembed permanentpen table',
            toolbar: 'a11ycheck addcomment showcomments casechange checklist code formatpainter pageembed permanentpen table',
            toolbar_mode: 'floating',
            tinycomments_mode: 'embedded',
            tinycomments_author: 'Author name',
            relative_urls: false,
            remove_script_host: false,
            convert_urls: true,
            //enable title field in the Image dialog
            image_title: true,
            // enable automatic uploads of images represented by blob or data URIs
            automatic_uploads: false,
            // add custom filepicker only to Image dialog
            file_picker_types: 'image',
            file_picker_callback: function (cb, value, meta) {
                var input = document.createElement('input');
                input.setAttribute('type', 'file');
                input.setAttribute('accept', 'image/*');

                input.onchange = function () {
                    var file = this.files[0];
                    var reader = new FileReader();

                    reader.onload = function () {
                        var id = 'blobid' + (new Date()).getTime();
                        var blobCache = tinymce.activeEditor.editorUpload.blobCache;
                        var base64 = reader.result.split(',')[1];
                        var blobInfo = blobCache.create(id, file, base64);
                        blobCache.add(blobInfo);

                        // call the callback and populate the Title field with the file name
                        cb(blobInfo.blobUri(), { title: file.name });
                    };
                    reader.readAsDataURL(file);
                };

                input.click();
            },
            images_upload_url: 'http://localhost:5500/post/upload-image'
            //images_upload_base_path: '/some/basepath'
        });
    </script>

    <!-- SAVE CONTENT -->
    <script>
        const btnSave = document.getElementById('save-button');
        btnSave.addEventListener('click', (e) => {
            e.preventDefault();
            tinymce.activeEditor.uploadImages(function(success) {
                
            })
        })
    </script>

    <!-- POST THUMBNAIL -->
    <script>
        const btnThumbnailPreview = document.querySelector('#thumbnail-preview-button');
        const modalThumbanilPreview = $('#thumbnail-preview-modal');
        btnThumbnailPreview.addEventListener('click', function () {
            //get value
            const title = document.getElementById('f-title').value,
                description = document.getElementById('f-description').value,
                category = document.getElementById('f-category').value,
                tags = document.getElementById('f-tags').value.split(' '),
                date = new Date();
            //set value
            document.querySelector('.title-post-thumbnail').innerText = title;
            document.querySelector('.description-post-thumbnail').innerText = description;
            document.querySelector('.category-post-thumbnail span').innerText = category;
            document.querySelector('.date').innerText = date.getDate();
            document.querySelector('.month').innerText = convertMonthToString(date.getMonth());

            const tagsPreview = document.querySelector('.tags-post-thumbnail');
            let tagChildren = document.querySelectorAll('.tags-post-thumbnail a');
            //remove all tags if exits
            tagChildren.forEach(tagChild => {
                tagChild.remove();
            });
            tags.forEach(tag => {
                if (tag === '')
                    return;
                const tagChild = document.createElement('a');
                tagChild.innerHTML = `<a href='#'>#${tag} </a>`;
                tagsPreview.appendChild(tagChild);
            });

            const fileInput = document.getElementById('cover-file-choose');
            readURL(fileInput);

            //show modal
            modalThumbanilPreview.modal();
        })

        function convertMonthToString(month) {
            switch (month) {
                case 0:
                    return 'Jan';
                case 1:
                    return 'Feb';
                case 2:
                    return 'Mar';
                case 3:
                    return 'Apr';
                case 4:
                    return 'May';
                case 5:
                    return 'Jun';
                case 6:
                    return 'Jul';
                case 7:
                    return 'Aug';
                case 8:
                    return 'Sep';
                case 9:
                    return 'Oct';
                case 10:
                    return 'Nov';
                case 11:
                    return 'Dec';
                default:
                    return '';
            }
        }


        function readURL(input) {
            const btnURL = document.querySelector('#cover-url-radio');
            if (btnURL.checked) {

                const imgPostThumbnailPreview = document.querySelector('.post-img-thumbnail');
                const imgPostDetailPreview = document.querySelector('.post-cover-image');
                const inputURL = document.querySelector('#cover-url-text').value;

                imgPostDetailPreview.src = inputURL;
                imgPostThumbnailPreview.src = inputURL;
                return;
            }

            if (input.files && input.files[0]) {
                var reader = new FileReader();
                reader.onload = function (e) {
                    const imgPostThumbnailPreview = document.querySelector('.post-img-thumbnail');
                    const imgPostDetailPreview = document.querySelector('.post-cover-image');
                    imgPostDetailPreview.src = e.target.result;
                    imgPostThumbnailPreview.src = e.target.result;
                }
                reader.readAsDataURL(input.files[0]); // convert to base64 string
            }
        }
    </script>

    <!-- rate -->
    <script>
        function mouseOver(id) {
            removeRate();
            let level = document.getElementById('level1');
            if (!level)
                return;
            while (level.id !== id) {
                //if (level)
                level.classList.add('hover-rate');
                level = level.nextElementSibling;
            }
            level.classList.add('hover-rate');
            if (level.id === 'level5')
                return;

            level = level.nextElementSibling;
            while (level.id !== 'level5') {
                level.classList.remove('hover-rate');
                level = level.nextElementSibling;
            }
            level.classList.remove('hover-rate');
        }

        function mouseOut() {

            let level = document.getElementById('level1');

            while (level.id !== 'level5') {
                level.classList.remove('hover-rate');
                level = level.nextElementSibling;
            }
            level.classList.remove('hover-rate');
            addRate();
        }
        function addRate() {
            let vote = 3;
            if (vote) {
                let level = document.getElementById('level1');
                if (!level)
                    return;
                while (level.id !== `level${vote}`) {
                    //if (level)
                    level.classList.add('rated');
                    level = level.nextElementSibling;
                }
                level.classList.add('rated');
                if (level.id === 'level5')
                    return;

                level = level.nextElementSibling;
                while (level.id !== 'level5') {
                    level.classList.remove('rared');
                    level = level.nextElementSibling;
                }
                level.classList.remove('rated');
            }
        }


        function removeRate(){
            let level = document.getElementById('level1');
            while (level.id !== 'level5') {
                level.classList.remove('rated');
                level = level.nextElementSibling;
            }
            level.classList.remove('rated');
        }


    </script>

    <!-- POST DETAIL -->
    <script>

        const convertDate = (dateObject) => {
            const date = dateObject.getDate();
            const month = dateObject.getMonth() + 1;
            const year = dateObject.getFullYear(dateObject);
            return `${date}/${month}/${year}`;
        }

        const btnPostDetaillPreview = document.querySelector('#post-detail-preview-button');
        const modalPostDetaillPreview = $('#post-detail-preview-modal');
        btnPostDetaillPreview.addEventListener('click', function () {
            //get value
            const title = document.getElementById('f-title').value,
                author = document.getElementById('f-author').value,
                category = document.getElementById('f-category').value,
                content = tinyMCE.activeEditor.getContent(),
                date = new Date();
            
            //set value
            document.querySelector('.post-detail-title').innerText = title;
            document.querySelector('.post-detail-author span').innerText = author;
            document.querySelector('.post-detail-category').innerText = category;
            document.querySelector('.post-detail-date').innerText = convertDate(date);
            document.querySelector('.post-detail-content').innerHTML = content;

            //read image
            const fileInput = document.getElementById('cover-file-choose');
            readURL(fileInput);

            //add rate
            const rateItems = document.querySelectorAll('.your-rate-wrapper i');
            addRate();
            rateItems.forEach(rateItem => {
                rateItem.addEventListener('mouseover', () => mouseOver(rateItem.id));
                rateItem.addEventListener('mouseout', () => mouseOut());
            });

            //show modal
            modalPostDetaillPreview.modal();

            function readURL(input) {
                const btnURL = document.querySelector('#cover-url-radio');
                if (btnURL.checked) {


                    const imgPostDetailPreview = document.querySelector('.post-cover-image');
                    const inputURL = document.querySelector('#cover-url-text').value;

                    imgPostDetailPreview.src = inputURL;

                    return;
                }

                if (input.files && input.files[0]) {
                    var reader = new FileReader();
                    reader.onload = function (e) {

                        const imgPostDetailPreview = document.querySelector('.post-cover-image');
                        imgPostDetailPreview.src = e.target.result;

                    }
                    reader.readAsDataURL(input.files[0]); // convert to base64 string
                }
            }
        })
    </script>

    <!-- IMAGE COVER -->
    <script>
        window.onload = function () {
            const radioInputs = document.querySelectorAll('input[name="f-cover"]');

            radioInputs[0].addEventListener('click', function () {

                if (this.checked) {
                    document.querySelector('#cover-url-text').classList.add('show');
                    document.querySelector('#cover-file-choose').classList.remove('show');
                } else {
                    document.querySelector('#cover-url-text').classList.remove('show');
                    document.querySelector('#cover-file-choose').classList.add('show');
                }
            })
            radioInputs[1].addEventListener('click', function () {

                if (this.checked) {
                    document.querySelector('#cover-url-text').classList.remove('show');
                    document.querySelector('#cover-file-choose').classList.add('show');
                } else {
                    document.querySelector('#cover-url-text').classList.add('show');
                    document.querySelector('#cover-file-choose').classList.remove('show');
                }
            })


        }
    </script>
</body>

</html